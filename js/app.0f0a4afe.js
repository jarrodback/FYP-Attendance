(function(e){function t(t){for(var a,s,o=t[0],u=t[1],l=t[2],d=0,f=[];d<o.length;d++)s=o[d],Object.prototype.hasOwnProperty.call(r,s)&&r[s]&&f.push(r[s][0]),r[s]=0;for(a in u)Object.prototype.hasOwnProperty.call(u,a)&&(e[a]=u[a]);c&&c(t);while(f.length)f.shift()();return i.push.apply(i,l||[]),n()}function n(){for(var e,t=0;t<i.length;t++){for(var n=i[t],a=!0,o=1;o<n.length;o++){var u=n[o];0!==r[u]&&(a=!1)}a&&(i.splice(t--,1),e=s(s.s=n[0]))}return e}var a={},r={app:0},i=[];function s(t){if(a[t])return a[t].exports;var n=a[t]={i:t,l:!1,exports:{}};return e[t].call(n.exports,n,n.exports,s),n.l=!0,n.exports}s.m=e,s.c=a,s.d=function(e,t,n){s.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},s.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},s.t=function(e,t){if(1&t&&(e=s(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(s.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var a in e)s.d(n,a,function(t){return e[t]}.bind(null,a));return n},s.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return s.d(t,"a",t),t},s.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},s.p="/FYP-Attendance/";var o=window["webpackJsonp"]=window["webpackJsonp"]||[],u=o.push.bind(o);o.push=t,o=o.slice();for(var l=0;l<o.length;l++)t(o[l]);var c=u;i.push([0,"chunk-vendors"]),n()})({0:function(e,t,n){e.exports=n("56d7")},"034f":function(e,t,n){"use strict";n("85ec")},"07fd":function(e,t,n){},"23a8":function(e,t,n){"use strict";n("42aa")},"24cf":function(e,t,n){"use strict";n("af77")},"2ed9":function(e,t,n){"use strict";n("07fd")},"42aa":function(e,t,n){},5507:function(e,t,n){},"56d7":function(e,t,n){"use strict";n.r(t);n("e260"),n("e6cf"),n("cca6"),n("a79d");var a=n("2b0e"),r=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{attrs:{id:"app"}},[n("div",[n("nav-bar"),n("sidebar-menu",{attrs:{menu:e.menu,hideToggle:!0,width:"250px"}}),n("router-view")],1)])},i=[],s=n("4776"),o=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[n("b-navbar",{attrs:{toggleable:"lg",type:"light"}},[n("b-collapse",{attrs:{id:"nav-collapse","is-nav":""}},[n("b-navbar-nav",{staticClass:"ml-auto"},[n("b-nav-item-dropdown",{attrs:{right:""},scopedSlots:e._u([{key:"button-content",fn:function(){return[n("em",[e._v(e._s(e.getUsername))]),n("b-img",{attrs:{src:e.getPhoto,thumbnail:"",fluid:"",width:32,height:32,alt:"Responsive image"}})]},proxy:!0}])},[n("b-dropdown-item",{attrs:{href:"#"},on:{click:function(t){return e.signOut()}}},[e._v("Sign Out")])],1)],1)],1)],1)],1)},u=[],l=n("2f62"),c=n("0e44");a["default"].use(l["a"]);var d=new l["a"].Store({plugins:[Object(c["a"])({storage:sessionStorage})],state:{loggedIn:!1,user:{id:null,email:null,username:null,type:null}},mutations:{setLoggedIn:function(e,t){e.loggedIn=t},setUser:function(e,t){e.user=t},setId:function(e,t){e.user.id=t},setEmail:function(e,t){e.user.email=t},setUsername:function(e,t){e.user.username=t},setType:function(e,t){e.user.type=t}},getters:{user:function(e){return e.user},loggedIn:function(e){return e.loggedIn}}}),f=n("1da1"),p=(n("96cf"),n("bc3a")),m=n.n(p),h="http://localhost:3050/auth/",v="http://localhost:3050/api/v1/user/",g={getUserDetails:function(){var e=Object(f["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.abrupt("return",m.a.get(h+"details",{withCredentials:!0}));case 1:case"end":return e.stop()}}),e)})));function t(){return e.apply(this,arguments)}return t}(),logout:function(){var e=Object(f["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.abrupt("return",m.a.post(h+"logout",{withCredentials:!0}));case 1:case"end":return e.stop()}}),e)})));function t(){return e.apply(this,arguments)}return t}(),updateModuleUser:function(){var e=Object(f["a"])(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.abrupt("return",m.a.put(v+"module",t,{withCredentials:!0}));case 1:case"end":return e.stop()}}),e)})));function t(t){return e.apply(this,arguments)}return t}(),getAllUsersEnrolledInModule:function(){var e=Object(f["a"])(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.abrupt("return",m.a.get(v+"module/".concat(t),{withCredentials:!0}));case 1:case"end":return e.stop()}}),e)})));function t(t){return e.apply(this,arguments)}return t}()},b={name:"nav-bar",computed:{getUsername:function(){return d.getters.user.username},getPhoto:function(){return d.getters.user.google.picture||""}},methods:{signOut:function(){var e=this;g.logout().then((function(){d.commit("setLoggedIn",!1),d.commit("setUser",{}),sessionStorage.clear(),e.$router.push("/overview").catch((function(){}))}))}}},y=b,_=n("2877"),M=Object(_["a"])(y,o,u,!1,null,null,null),w=M.exports,A={name:"App",components:{SidebarMenu:s["SidebarMenu"],"nav-bar":w},data:function(){return{menu:[{header:!0,title:"Attendance System",hiddenOnCollapse:!1},{header:!0,title:"Main",hiddenOnCollapse:!1,hidden:!this.isUserStudent()},{href:"/overview",title:"Overview",icon:"fa fa-book-open",hidden:!this.isUserStudent()},{href:"/analytics",title:"Analytics",icon:"fa fa-chart-pie",hidden:!this.isUserStudent()},{href:"/activity",title:"Activity",icon:"fa fa-chart-line",hidden:!this.isUserStudent()},{header:!0,title:"Admin",hiddenOnCollapse:!1,hidden:!this.isUserAdmin()},{href:"/modules",title:"My Modules",icon:"fa fa-book",hidden:!this.isUserAdmin()}]}},methods:{isUserAdmin:function(){return"Lecturer"==d.getters.user.type},isUserStudent:function(){return"Student"==d.getters.user.type}}},k=A,x=(n("034f"),Object(_["a"])(k,r,i,!1,null,null,null)),O=x.exports,S=n("8c4f"),C=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[n("h1",[e._v("Overview")]),n("my-modules",{ref:"myModules",on:{openCreateModal:e.openCreateModal}}),n("create-modal",{ref:"createModal",on:{refreshModules:e.refreshModules}})],1)},U=[],E=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[n("div",{staticClass:"submit-btn"},[n("b-button",{attrs:{variant:"info"},on:{click:e.openModal}},[e._v(" Set Target ")])],1),n("h3",{staticClass:"h3-overview"},[e._v(" My Modules ")]),n("div",{staticClass:"overflow-auto center"},[n("b-table",{attrs:{id:"module-table",striped:"",items:e.modules,fields:e.fields,"sort-by":e.sortBy,"sort-desc":e.sortDesc,responsive:"sm"},on:{"update:sortBy":function(t){e.sortBy=t},"update:sort-by":function(t){e.sortBy=t},"update:sortDesc":function(t){e.sortDesc=t},"update:sort-desc":function(t){e.sortDesc=t}},scopedSlots:e._u([{key:"cell(attendanceRating)",fn:function(t){return[e._v(" "+e._s(t.item.attendanceRating)+"% ")]}},{key:"cell(target)",fn:function(t){return[e.targetExists(t.item)?n("b-form-checkbox",{staticClass:"mb-3",attrs:{checked:t.item.target,disabled:!0}}):e._e(),e.targetExists(t.item)?e._e():n("b-progress",[n("b-progress-bar",{attrs:{value:t.item.attendanceRating,max:t.item.Module_User.target,"show-progress":"",animated:"",variant:"danger"}},[n("span",[e._v("Progress: "+e._s(t.item.attendanceRating)+"/"+e._s(t.item.Module_User.target)+"%")])])],1)]}}])})],1)])},D=[],j=n("b85c"),T={name:"my-modules",mounted:function(){this.getModules()},computed:{fields:function(){return[{key:"name",sortable:!0,label:"Module Name"},{key:"attendanceRating",sortable:!0,label:"Attendance Rating"},{key:"target",label:"Target"}]}},data:function(){return{modules:[],sortBy:"attendanceScore",sortDesc:!1}},methods:{getModules:function(){var e=this;g.getUserDetails().then((function(t){e.modules=t.data.Modules;var n,a=Object(j["a"])(e.modules);try{for(a.s();!(n=a.n()).done;){var r=n.value;r.attendanceRating=r.Module_User.attendedSessions/r.numberOfSessions*100,r.Module_User.target&&(r.target=r.attendanceRating>=r.Module_User.target)}}catch(i){a.e(i)}finally{a.f()}}))},targetExists:function(e){return null!=e.target&&e.target},openModal:function(){this.$emit("openCreateModal",this.modules)}}},$=T,I=(n("24cf"),Object(_["a"])($,E,D,!1,null,null,null)),R=I.exports,P=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[n("b-modal",{ref:"create-modal",attrs:{id:"create-target-modal",title:"Create Attendance Target",okVariant:"info",okTitle:"Create"},on:{ok:e.handleOk}},[n("b-form",{ref:"createTargetForm",on:{submit:function(t){return t.stopPropagation(),t.preventDefault(),e.handleSubmit.apply(null,arguments)}}},[n("b-form-group",{attrs:{label:"Module","label-for":"module-input","invalid-feedback":"Module is required",state:e.isModuleValid}},[n("b-form-select",{attrs:{id:"module-input",options:e.options},model:{value:e.createModal.module,callback:function(t){e.$set(e.createModal,"module",t)},expression:"createModal.module"}})],1),n("b-form-group",{attrs:{label:"Attendance Target","label-for":"target-input","invalid-feedback":"Target is required. Must be between 50 and 100%"}},[n("b-form-input",{attrs:{type:"number",step:"1",id:"target-input",state:e.isTargetValid},model:{value:e.createModal.target,callback:function(t){e.$set(e.createModal,"target",t)},expression:"createModal.target"}})],1)],1)],1)],1)},L=[],V=(n("d3b7"),n("159b"),n("b0c0"),n("caad"),n("2532"),function(e,t,n){var a=!(arguments.length>3&&void 0!==arguments[3])||arguments[3];return e.$notify({message:t,type:n,top:!0,right:!0,showClose:a})}),F={name:"create-modal",computed:{isTargetValid:function(){return!!this.createModal.target&&this.validTarget()},isModuleValid:function(){return!!this.createModal.module&&this.validModule()},isFormValid:function(){return this.isTargetValid&&this.isModuleValid}},data:function(){return{createModal:{},options:[]}},methods:{openCreateModal:function(e){var t=this;e.forEach((function(e){t.options.push(e.name)})),this.targets=e,this.$refs["create-modal"].show()},handleOk:function(e){this.isFormValid?this.createTarget():e.preventDefault()},validTarget:function(){return this.createModal.target>=50&&this.createModal.target<=100},validModule:function(){return this.options.includes(this.createModal.module)},createTarget:function(){var e,t=this;this.targets.forEach((function(n){n.name==t.createModal.module&&(e=n)}));var n={ModuleId:e.Module_User.ModuleId,UserId:e.Module_User.UserId,target:this.createModal.target};g.updateModuleUser(n).then((function(){t.$emit("refreshModules"),V(t,"Successfully updated target.","darkenSuccess")})).catch((function(){V(t,"Failed to update targets.","darkenError")}))}}},B=F,N=Object(_["a"])(B,P,L,!1,null,null,null),Y=N.exports,q={name:"overview",components:{"my-modules":R,"create-modal":Y},computed:{getUsername:function(){return d.getters.user.username}},methods:{refreshModules:function(){this.$refs.myModules.getModules()},openCreateModal:function(e){this.$refs.createModal.openCreateModal(e)}}},J=q,H=Object(_["a"])(J,C,U,!1,null,null,null),W=H.exports,z=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[n("h1",[e._v("Activity")]),n("view-activity")],1)},G=[],K=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"container"},[n("div",{staticClass:"activity"},[n("h3",[e._v("Recent Activity")]),n("div",{staticClass:"activity-content"},e._l(this.activity,(function(t,a){return n("div",{key:a,staticClass:"date"},[n("h4",[e._v(e._s(a)+" - "+e._s(new Date(t[0].attendedAt).toString().substring(0,3)))]),e._l(t,(function(t,a){return n("div",{key:a},[e._v("You "),n("strong",[e.isAttended(t.type)?n("span",{style:e.attendedStyle(t.type)},[e._v("attended")]):e._e(),e.isAttended(t.type)?e._e():n("span",{style:e.attendedStyle(t.type)},[e._v("missed")])]),e._v(" "),n("strong",[e._v(e._s(t.module))]),e._v(" at "+e._s(new Date(t.attendedAt).toISOString().split("T")[1].split(".")[0]))])}))],2)})),0)]),n("div",{staticClass:"history"},[n("h3",[e._v("History")]),n("b-calendar",{attrs:{"date-info-fn":e.dateClass,"date-disabled-fn":e.dateDisabled,locale:"en","hide-header":!0,readonly:!0,block:""},model:{value:e.value,callback:function(t){e.value=t},expression:"value"}})],1)])},Q=[],X=(n("ac1f"),n("1276"),{name:"activity",mounted:function(){this.getActivity()},computed:{},data:function(){return{activity:[],sortBy:"attendanceScore",sortDesc:!1,value:""}},methods:{getActivity:function(){var e=this;g.getUserDetails().then((function(t){var n=t.data.activity.reduce((function(e,t){var n=t.attendedAt;t.attendedAt&&(n=new Date(n).toISOString().split("T")[0]);var a=e[n]||[];return a.push(t),e[n]=a,e}),{});e.activity=n}))},dateClass:function(e,t){var n=new Date(t).toISOString().split("T")[0];if(this.activity[n]){var a=!1;return this.activity[n].forEach((function(e){"Missed"==e.type&&(a=!0)})),a?"table-danger":"table-success"}return" "},dateDisabled:function(e,t){var n=t.getDay(),a=t.getDate();return 0===n||6===n||13===a},isAttended:function(e){return"Attended"===e},attendedStyle:function(e){return"Attended"===e?{color:"green"}:{color:"red"}}}}),Z=X,ee=(n("be29"),Object(_["a"])(Z,K,Q,!1,null,null,null)),te=ee.exports,ne={name:"activity",components:{"view-activity":te}},ae=ne,re=Object(_["a"])(ae,z,G,!1,null,null,null),ie=re.exports,se=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[n("h1",[e._v("Analytics")]),n("view-analytics",{attrs:{categories:e.categories,data30Line:e.data30Line,data30:e.data30,dataAll:e.dataAll}})],1)},oe=[],ue=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[n("b-card",[n("h4",[e._v("Last 30 days")]),n("VueApexCharts",{attrs:{height:"250px",options:e.options,series:e.series30Pie.data,title:e.series30Pie.name,type:"pie"}}),n("VueApexCharts",{attrs:{height:"250px",options:e.optionsLine,series:e.series30,title:e.series30.name,type:"line"}})],1),n("b-card",[n("h4",[e._v("All time")]),n("VueApexCharts",{attrs:{height:"250px",options:e.options,series:e.seriesAll.data,title:e.seriesAll.name,type:"pie"}})],1)],1)},le=[],ce=n("1321"),de=n.n(ce),fe={name:"analytics",components:{VueApexCharts:de.a},computed:{},props:{categories:[],data30Line:[],data30:[],dataAll:[]},data:function(){return{series30Pie:{name:"Analytics for attendance for the last 30 days",data:this.data30},series30:[{name:"Analytics for attendance for the last 30 days",data:this.data30Line}],seriesAll:{name:"Analytics for attendance for all time",data:this.dataAll},optionsLine:{noData:{text:"No activity data to show..."},legend:{position:"bottom"},xaxis:{categories:this.categories}},options:{labels:["Attended","Missed"],noData:{text:"No activity data to show..."},legend:{position:"bottom"},xaxis:{categories:this.categories}},activity:[]}},methods:{}},pe=fe,me=Object(_["a"])(pe,ue,le,!1,null,null,null),he=me.exports,ve={name:"analytics",mounted:function(){this.getActivity()},components:{"view-analytics":he},data:function(){return{categories:[],data30Line:[],data30:[],dataAll:[]}},methods:{getActivity:function(){var e=this;g.getUserDetails().then((function(t){var n=t.data.activity.reduce((function(e,t){var n=t.attendedAt;t.attendedAt&&(n=new Date(n).toISOString().split("T")[0]);var a=e[n]||[];return a.push(t),e[n]=a,e}),{});e.activity=n,e.calculateAnalytics()}))},calculateAnalytics:function(){var e=0,t=0,n=0,a=0,r=0,i=new Date,s=new Date;for(var o in s.setDate(s.getDate()-30),this.activity){i=new Date(o);var u=i.getTime()-s.getTime();u/=864e5,u<=30?(this.categories.push(o),this.activity[o].forEach((function(i){"Attended"==i.type&&(t++,a++,e++),"Missed"==i.type&&(n++,r++)})),this.data30Line.push(e)):this.activity[o].forEach((function(e){"Attended"==e.type&&a++,"Missed"==e.type&&r++}))}this.dataAll.push(a),this.dataAll.push(r),this.data30.push(t),this.data30.push(n)}}},ge=ve,be=Object(_["a"])(ge,se,oe,!1,null,null,null),ye=be.exports,_e=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[n("h1",[e._v("Modules")]),n("view-modules")],1)},Me=[],we=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",e._l(e.modulesComputed,(function(t,a){return n("b-card",{key:a},[n("h3",{staticClass:"h3-overview"},[e._v(" "+e._s(t.name)+" ")]),n("div",{staticClass:"overflow-auto center"},[n("b-table",{attrs:{id:"module-table",striped:"",items:t.users,fields:e.fields,responsive:"sm"}})],1)])})),1)},Ae=[],ke={name:"my-modules",mounted:function(){this.getModules()},computed:{fields:function(){return[{key:"username",sortable:!0,label:"Enrolled Students"}]},modulesComputed:function(){return console.log("RETURN: ",this.modules),this.modules}},data:function(){return{modules:[]}},methods:{getModules:function(){var e=this;g.getUserDetails().then((function(t){e.modules=t.data.Modules,e.modules.forEach((function(e){var t=e.Module_User.ModuleId;g.getAllUsersEnrolledInModule(t).then((function(t){e.users=t.data}))}))}))}}},xe=ke,Oe=(n("2ed9"),Object(_["a"])(xe,we,Ae,!1,null,null,null)),Se=Oe.exports,Ce={name:"modules",components:{"view-modules":Se}},Ue=Ce,Ee=Object(_["a"])(Ue,_e,Me,!1,null,null,null),De=Ee.exports,je=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[n("h1",[e._v("404: Page Not Found")]),n("p",[e._v(" You will be redirect in 5 seconds... ")]),n("br"),n("p",[e._v(" Click "),n("b-link",{on:{click:e.redirect}},[e._v("here")]),e._v(" if you aren't redirected")],1)])},Te=[],$e={name:"NotFound",created:function(){var e=this;setTimeout((function(){return e.redirect()}),5e3)},methods:{redirect:function(){this.$router.back()}}},Ie=$e,Re=(n("23a8"),Object(_["a"])(Ie,je,Te,!1,null,"5ed0c70e",null)),Pe=Re.exports,Le=function(e,t,n){d.state.loggedIn?n():g.getUserDetails().then((function(e){d.commit("setLoggedIn",!0),d.commit("setUser",{id:e.data.id,email:e.data.email,username:e.data.username,type:e.data.type,modules:e.data.Modules,google:e.data.google}),d.commit("setLoggedIn",!0),n()})).catch((function(){window.location.href="https://fyp-attendance-system.herokuapp.com//auth/google"}))};a["default"].use(S["a"]);var Ve=new S["a"]({mode:"history",base:"/FYP-Attendance/",linkActiveClass:"active",routes:[{path:"/",name:"overview",component:W,beforeEnter:Le},{path:"/overview",name:"overview",component:W,beforeEnter:Le},{path:"/activity",name:"activity",component:ie,beforeEnter:Le},{path:"/analytics",name:"analytics",component:ye,beforeEnter:Le},{path:"/modules",name:"modules",component:De,beforeEnter:Le},{path:"/*",component:Pe}]}),Fe=n("5f5b"),Be=n("b1e0"),Ne=n("ed09"),Ye=n("d10e"),qe=n("5887"),Je=n.n(qe);n("f9e3"),n("2dd8"),n("5aea"),n("b15b"),n("15f5");a["default"].use(Ne["a"]),a["default"].config.productionTip=!1,a["default"].use(Fe["a"]),a["default"].use(Be["a"]),a["default"].use(Ye["a"],{theme:{colors:{success:"#54d861",darkenSuccess:"#2d8e36",info:"#5d6a89",darkenInfo:"#535f7b",warning:"#f8a623",darkenWarning:"#f69a07",error:"#cc0000",darkenError:"#ff245f",offline:"#ff4577",darkenOffline:"#ff245f"}}}),a["default"].use(Je.a,{componentPrefix:"vc"}),new a["default"]({router:Ve,render:function(e){return e(O)}}).$mount("#app")},"5aea":function(e,t,n){},"85ec":function(e,t,n){},af77:function(e,t,n){},be29:function(e,t,n){"use strict";n("5507")}});
//# sourceMappingURL=app.0f0a4afe.js.map